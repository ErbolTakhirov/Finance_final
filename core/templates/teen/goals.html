{% extends 'teen/base.html' %}

{% block title %}–ú–æ–∏ —Ü–µ–ª–∏ - SB Finance AI{% endblock %}

{% block content %}
<!-- Goals Header -->
<div class="row mb-4">
    <div class="col-12">
        <div class="teen-card p-4">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="h2 mb-2">
                        <i class="bi bi-bullseye me-2"></i>–ú–æ–∏ —Ü–µ–ª–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è
                    </h1>
                    <p class="text-muted mb-0">
                        –°—Ç–∞–≤—å—Ç–µ —Ü–µ–ª–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –¥–æ—Å—Ç–∏–≥–∞–π—Ç–µ –º–µ—á—Ç—ã!
                    </p>
                </div>
                <div class="col-lg-4 text-lg-end">
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createGoalModal">
                        <i class="bi bi-plus-circle me-2"></i>–ù–æ–≤–∞—è —Ü–µ–ª—å
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Goals Overview Stats -->
<div class="row mb-4">
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="stat-card">
            <div class="stat-number">{{ active_goals.count|default:0 }}</div>
            <div class="stat-label">
                <i class="bi bi-bullseye me-1"></i>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ü–µ–ª–µ–π
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="stat-card">
            <div class="stat-number">{{ completed_goals.count|default:0 }}</div>
            <div class="stat-label">
                <i class="bi bi-check-circle me-1"></i>–î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="stat-card">
            <div class="stat-number">{{ total_saved|floatformat:0 }}</div>
            <div class="stat-label">
                <i class="bi bi-coin me-1"></i>–í—Å–µ–≥–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–æ
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6 mb-3">
        <div class="stat-card">
            <div class="stat-number">
                {% if active_goals %}
                    {{ active_goals.0.progress_percentage|floatformat:0|default:0 }}
                {% else %}
                    0
                {% endif %}%
            </div>
            <div class="stat-label">
                <i class="bi bi-graph-up me-1"></i>–ü—Ä–æ–≥—Ä–µ—Å—Å –≥–ª–∞–≤–Ω–æ–π —Ü–µ–ª–∏
            </div>
        </div>
    </div>
</div>

<!-- Active Goals -->
<div class="row">
    <div class="col-lg-8">
        <div class="teen-card p-4 mb-4">
            <h3 class="h5 mb-3">
                <i class="bi bi-play-circle me-2"></i>–ê–∫—Ç–∏–≤–Ω—ã–µ —Ü–µ–ª–∏
            </h3>
            
            {% if active_goals %}
                {% for goal in active_goals %}
                <div class="goal-card">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center mb-2">
                                <h6 class="mb-0 me-3">{{ goal.title }}</h6>
                                <span class="badge bg-{{ goal.category|default:'secondary' }}">{{ goal.get_category_display }}</span>
                            </div>
                            <p class="text-muted small mb-3">{{ goal.description|default:"–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ" }}</p>
                            
                            <div class="row align-items-center mb-2">
                                <div class="col-sm-8">
                                    <div class="progress mb-2">
                                        <div class="progress-bar" style="width: {{ goal.progress_percentage }}%"></div>
                                    </div>
                                    <small class="text-muted">
                                        {{ goal.current_amount|floatformat:0 }} / {{ goal.target_amount|floatformat:0 }} —Å–æ–º
                                    </small>
                                </div>
                                <div class="col-sm-4 text-sm-end">
                                    <div class="goal-progress">{{ goal.progress_percentage|floatformat:0 }}%</div>
                                </div>
                            </div>
                            
                            {% if goal.ai_recommendation %}
                            <div class="alert alert-info py-2 mb-2">
                                <small><i class="bi bi-robot me-1"></i>{{ goal.ai_recommendation|truncatechars:120 }}</small>
                            </div>
                            {% endif %}
                            
                            {% if goal.weekly_saving_suggestion > 0 %}
                            <small class="text-success">
                                <i class="bi bi-lightning me-1"></i>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å {{ goal.weekly_saving_suggestion|floatformat:0 }} —Å–æ–º –≤ –Ω–µ–¥–µ–ª—é
                            </small>
                            {% endif %}
                        </div>
                        <div class="col-md-4">
                            <div class="d-grid gap-2">
                                <button class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#updateGoalModal{{ goal.id }}">
                                    <i class="bi bi-plus-circle me-1"></i>–î–æ–±–∞–≤–∏—Ç—å —Å—É–º–º—É
                                </button>
                                <button class="btn btn-outline-primary btn-sm" data-bs-toggle="modal" data-bs-target="#goalDetailsModal{{ goal.id }}">
                                    <i class="bi bi-info-circle me-1"></i>–ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                </button>
                                <form method="post" action="{% url 'teen:update_goal_status' goal.id %}" class="d-inline">
                                    {% csrf_token %}
                                    <input type="hidden" name="status" value="paused">
                                    <button type="submit" class="btn btn-outline-warning btn-sm w-100">
                                        <i class="bi bi-pause me-1"></i>–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    {% if goal.days_remaining > 0 %}
                    <div class="row mt-3">
                        <div class="col-12">
                            <small class="text-muted">
                                <i class="bi bi-calendar me-1"></i>–î–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è: {{ goal.days_remaining }} –¥–Ω–µ–π
                                ({{ goal.target_date|date:"d.m.Y" }})
                            </small>
                        </div>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            {% else %}
                <div class="text-center py-5">
                    <i class="bi bi-bullseye" style="font-size: 4rem; color: #d1d5db;"></i>
                    <h4 class="mt-3 text-muted">–ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ü–µ–ª–µ–π</h4>
                    <p class="text-muted">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é —Ü–µ–ª—å –∏ –Ω–∞—á–Ω–∏—Ç–µ —Å–≤–æ–π –ø—É—Ç—å –∫ –º–µ—á—Ç–µ!</p>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createGoalModal">
                        <i class="bi bi-plus-circle me-2"></i>–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é —Ü–µ–ª—å
                    </button>
                </div>
            {% endif %}
        </div>
        
        <!-- Completed Goals -->
        {% if completed_goals %}
        <div class="teen-card p-4">
            <h3 class="h5 mb-3">
                <i class="bi bi-check-circle me-2 text-success"></i>–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏
            </h3>
            
            <div class="row">
                {% for goal in completed_goals %}
                <div class="col-md-6 mb-3">
                    <div class="achievement-badge earned">
                        <div class="achievement-icon">üéâ</div>
                        <h6 class="mb-1">{{ goal.title }}</h6>
                        <p class="text-muted small mb-2">{{ goal.target_amount|floatformat:0 }} —Å–æ–º</p>
                        <small class="text-success">
                            <i class="bi bi-check me-1"></i>–î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ {{ goal.completed_at|date:"d.m.Y" }}
                        </small>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    
    <!-- Sidebar -->
    <div class="col-lg-4">
        <!-- Goal Achievements -->
        <div class="teen-card p-4 mb-4">
            <h4 class="h6 mb-3">
                <i class="bi bi-trophy me-2"></i>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ —Ü–µ–ª—è–º
            </h4>
            
            {% if goal_achievements %}
                {% for user_achievement in goal_achievements %}
                <div class="d-flex align-items-center mb-3">
                    <div class="achievement-icon me-3">{{ user_achievement.achievement.icon }}</div>
                    <div>
                        <h6 class="mb-1 small">{{ user_achievement.achievement.title }}</h6>
                        <small class="text-muted">{{ user_achievement.earned_at|date:"d.m.Y" }}</small>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="text-center py-3">
                    <i class="bi bi-trophy" style="font-size: 2rem; color: #d1d5db;"></i>
                    <p class="text-muted small mt-2">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</p>
                </div>
            {% endif %}
        </div>
        
        <!-- Goal Categories -->
        <div class="teen-card p-4 mb-4">
            <h4 class="h6 mb-3">
                <i class="bi bi-grid me-2"></i>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ü–µ–ª–µ–π
            </h4>
            
            {% if active_goals %}
                {% for category, count in active_goals|groupby:'category' %}
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="small">{{ category|title }}</span>
                    <span class="badge bg-primary">{{ count|length }}</span>
                </div>
                {% endfor %}
            {% else %}
                <div class="text-center py-3">
                    <p class="text-muted small">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ü–µ–ª–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö!</p>
                </div>
            {% endif %}
        </div>
        
        <!-- AI Goal Tips -->
        <div class="teen-card p-4">
            <h4 class="h6 mb-3">
                <i class="bi bi-lightbulb me-2"></i>–°–æ–≤–µ—Ç—ã –æ—Ç AI
            </h4>
            
            <div class="alert alert-info">
                <i class="bi bi-robot me-2"></i>
                <strong>–°–æ–≤–µ—Ç:</strong> –õ—É—á—à–µ –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ü–µ–ª–µ–π, —á–µ–º –æ–¥–Ω—É –±–æ–ª—å—à—É—é. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–µ–µ —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å!
            </div>
            
            <div class="alert alert-success">
                <i class="bi bi-lightning me-2"></i>
                <strong>–õ–∞–π—Ñ—Ö–∞–∫:</strong> –û—Ç–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ —Å–¥–∞—á—É –æ—Ç –ø–æ–∫—É–ø–æ–∫ - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –Ω–∞—á–∞—Ç—å –∫–æ–ø–∏—Ç—å!
            </div>
        </div>
    </div>
</div>

<!-- Create Goal Modal -->
<div class="modal fade" id="createGoalModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content teen-card">
            <div class="modal-header border-0">
                <h5 class="modal-title">
                    <i class="bi bi-plus-circle me-2"></i>–ù–æ–≤–∞—è —Ü–µ–ª—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="post" action="{% url 'teen:create_goal' %}">
                {% csrf_token %}
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏ *</label>
                                <input type="text" class="form-control" name="title" required 
                                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: iPhone 15, –Ω–æ—É—Ç–±—É–∫, –∫—É—Ä—Å—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                <select class="form-select" name="category">
                                    <option value="electronics">–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
                                    <option value="fashion">–û–¥–µ–∂–¥–∞</option>
                                    <option value="education">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                                    <option value="entertainment">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                                    <option value="travel">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</option>
                                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" name="description" rows="3" 
                                  placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –æ —Ü–µ–ª–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">–¶–µ–ª–µ–≤–∞—è —Å—É–º–º–∞ (—Å–æ–º) *</label>
                                <input type="number" class="form-control" name="target_amount" required 
                                       step="0.01" min="0" placeholder="50000">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">–ñ–µ–ª–∞–µ–º–∞—è –¥–∞—Ç–∞ *</label>
                                <input type="date" class="form-control" name="target_date" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        <strong>AI –ø–æ–º–æ–∂–µ—Ç:</strong> –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ª–∏ AI –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∞—à—É —Å–∏—Ç—É–∞—Ü–∏—é –∏ –¥–∞—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –ø–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—é.
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>–°–æ–∑–¥–∞—Ç—å —Ü–µ–ª—å
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Update Goal Progress Modals -->
{% for goal in active_goals %}
<div class="modal fade" id="updateGoalModal{{ goal.id }}" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content teen-card">
            <div class="modal-header border-0">
                <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Å—É–º–º—É –∫: {{ goal.title }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="post" action="{% url 'teen:update_goal_progress' goal.id %}">
                {% csrf_token %}
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">–¢–µ–∫—É—â–∞—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ (—Å–æ–º)</label>
                        <input type="number" class="form-control" name="current_amount" 
                               value="{{ goal.current_amount|floatformat:0 }}" step="0.01" min="0">
                        <div class="form-text">
                            –°–µ–π—á–∞—Å –Ω–∞–∫–æ–ø–ª–µ–Ω–æ: {{ goal.current_amount|floatformat:0 }} —Å–æ–º
                            {% if goal.weekly_saving_suggestion > 0 %}
                            ‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å {{ goal.weekly_saving_suggestion|floatformat:0 }} —Å–æ–º/–Ω–µ–¥–µ–ª—é
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="progress mb-3">
                        <div class="progress-bar" style="width: {{ goal.progress_percentage }}%"></div>
                    </div>
                    
                    {% if goal.progress_percentage >= 100 %}
                    <div class="alert alert-success">
                        <i class="bi bi-check-circle me-2"></i>
                        <strong>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</strong> –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —Å–≤–æ–µ–π —Ü–µ–ª–∏!
                    </div>
                    {% endif %}
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">
                        <i class="bi bi-check-circle me-2"></i>–û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Goal Details Modal -->
<div class="modal fade" id="goalDetailsModal{{ goal.id }}" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content teen-card">
            <div class="modal-header border-0">
                <h5 class="modal-title">{{ goal.title }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="mb-3">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–µ–ª–∏</h6>
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong></td>
                                <td>{{ goal.get_category_display }}</td>
                            </tr>
                            <tr>
                                <td><strong>–¶–µ–ª–µ–≤–∞—è —Å—É–º–º–∞:</strong></td>
                                <td>{{ goal.target_amount|floatformat:0 }} —Å–æ–º</td>
                            </tr>
                            <tr>
                                <td><strong>–ù–∞–∫–æ–ø–ª–µ–Ω–æ:</strong></td>
                                <td>{{ goal.current_amount|floatformat:0 }} —Å–æ–º</td>
                            </tr>
                            <tr>
                                <td><strong>–ü—Ä–æ–≥—Ä–µ—Å—Å:</strong></td>
                                <td>{{ goal.progress_percentage|floatformat:0 }}%</td>
                            </tr>
                            <tr>
                                <td><strong>–ñ–µ–ª–∞–µ–º–∞—è –¥–∞—Ç–∞:</strong></td>
                                <td>{{ goal.target_date|date:"d.m.Y" }}</td>
                            </tr>
                            {% if goal.days_remaining > 0 %}
                            <tr>
                                <td><strong>–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π:</strong></td>
                                <td>{{ goal.days_remaining }}</td>
                            </tr>
                            {% endif %}
                        </table>
                    </div>
                    <div class="col-md-6">
                        <h6 class="mb-3">–ü—Ä–æ–≥—Ä–µ—Å—Å</h6>
                        <div class="text-center mb-3">
                            <div class="stat-number" style="font-size: 3rem;">{{ goal.progress_percentage|floatformat:0 }}%</div>
                            <div class="progress mb-3">
                                <div class="progress-bar" style="width: {{ goal.progress_percentage }}%"></div>
                            </div>
                            <p class="text-muted">{{ goal.current_amount|floatformat:0 }} –∏–∑ {{ goal.target_amount|floatformat:0 }} —Å–æ–º</p>
                        </div>
                        
                        {% if goal.weekly_target > 0 %}
                        <div class="alert alert-info">
                            <i class="bi bi-calculator me-2"></i>
                            <strong>–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∫ —Å—Ä–æ–∫—É:</strong><br>
                            –û—Ç–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ {{ goal.weekly_target|floatformat:0 }} —Å–æ–º –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é
                        </div>
                        {% endif %}
                    </div>
                </div>
                
                {% if goal.ai_recommendation %}
                <div class="mt-4">
                    <h6 class="mb-3">–°–æ–≤–µ—Ç –æ—Ç AI</h6>
                    <div class="alert alert-primary">
                        {{ goal.ai_recommendation }}
                    </div>
                </div>
                {% endif %}
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#updateGoalModal{{ goal.id }}" data-bs-dismiss="modal">
                    <i class="bi bi-plus-circle me-2"></i>–î–æ–±–∞–≤–∏—Ç—å —Å—É–º–º—É
                </button>
            </div>
        </div>
    </div>
</div>
{% endfor %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Set default date to 3 months from now
    const targetDateInput = document.querySelector('input[name="target_date"]');
    if (targetDateInput) {
        const futureDate = new Date();
        futureDate.setMonth(futureDate.getMonth() + 3);
        targetDateInput.value = futureDate.toISOString().split('T')[0];
    }
    
    // Real-time progress calculation
    const progressBars = document.querySelectorAll('.progress-bar');
    progressBars.forEach(bar => {
        const width = bar.style.width;
        if (parseInt(width) >= 100) {
            bar.classList.add('bg-success');
        } else if (parseInt(width) >= 50) {
            bar.classList.add('bg-warning');
        }
    });
});
</script>
{% endblock %}