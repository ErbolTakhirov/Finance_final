{% extends 'base.html' %}
{% block title %}Transactions - SB FINANCE AI{% endblock %}

{% block content %}
<h1>Transactions</h1>

<div class="grid">
  <div class="col-6">
    <div class="card">
      <h3>Add Transaction</h3>
      <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button class="btn" type="submit">Save</button>
      </form>
    </div>

    <div class="card">
      <h3>Last 12 months summaries</h3>
      <table>
        <thead><tr><th>Month</th><th>Income</th><th>Expense</th><th>Profit</th></tr></thead>
        <tbody>
          {% for s in summaries %}
            <tr>
              <td>{{ s.month_key }}</td>
              <td>{{ s.total_income }}</td>
              <td>{{ s.total_expense }}</td>
              <td><strong>{{ s.profit }}</strong></td>
            </tr>
          {% empty %}
            <tr><td colspan="4" class="muted">No summaries yet</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="col-6">
    <div class="card">
      <h3>Latest transactions</h3>
      <table>
        <thead><tr><th>Date</th><th>Type</th><th>Category</th><th>Amount</th></tr></thead>
        <tbody>
          {% for tx in transactions %}
            <tr>
              <td>{{ tx.date }}</td>
              <td><span class="pill">{{ tx.type }}</span></td>
              <td>{{ tx.category }}</td>
              <td>{% if tx.type == 'income' %}+{% else %}-{% endif %}{{ tx.amount }}</td>
            </tr>
          {% empty %}
            <tr><td colspan="4" class="muted">No transactions yet</td></tr>
          {% endfor %}
        </tbody>
      </table>
      <p class="muted">For full CRUD use the DRF API: <a href="/api/finance/transactions/">/api/finance/transactions/</a></p>
    </div>
  </div>
</div>
{% endblock %}
